{% extends 'users/base.html' %}

{% block title %}Activation du compte - Dangote Cement{% endblock %}

{% block header_title %}Activation du compte{% endblock %}
{% block header_subtitle %}Bienvenue {{ user.first_name }} {{ user.last_name }}{% endblock %}

{% block content %}
<div class="alert alert-info mb-4">
    <i class="fas fa-info-circle"></i>
    <strong>Première connexion</strong><br>
    Veuillez saisir vos identifiants temporaires reçus par email pour activer votre compte.
</div>

<form method="post" id="activateForm">
    {% csrf_token %}
    
    <div class="floating-group">
        <div class="floating-wrapper">
            <input 
                type="email" 
                class="floating-input"
                id="email" 
                name="email" 
                value="{{ user.email }}"
                placeholder=" "
                readonly
                style="background-color: #f8f9fa;"
            >
            <label for="email" class="floating-label">
                Adresse email
            </label>
        </div>
        <small class="text-muted">Votre adresse email est pré-remplie</small>
    </div>
    
    <div class="floating-group">
        <div class="floating-wrapper with-toggle">
            <input 
                type="password" 
                class="floating-input"
                id="temp_password" 
                name="temp_password" 
                placeholder=" "
                required
                autofocus
            >
            <label for="temp_password" class="floating-label">
                Mot de passe temporaire
            </label>
            <button type="button" class="password-toggle" id="togglePassword">
                <i class="fas fa-eye"></i>
            </button>
        </div>
        <small class="text-muted">
            <i class="fas fa-exclamation-triangle"></i> 
            Copiez-collez le mot de passe exactement comme reçu dans l'email
        </small>
    </div>
    
    <button type="submit" class="login-btn">
        <i class="fas fa-check-circle"></i> Valider et continuer
    </button>
</form>
 
<div class="text-center mt-4">
    <p class="text-muted">
        <small>
            <i class="fas fa-envelope"></i> 
            Vous n'avez pas reçu l'email ? Vérifiez vos spams ou contactez l'administrateur.
        </small>
    </p>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Toggle password visibility
    document.getElementById('togglePassword').addEventListener('click', function() {
        const passwordInput = document.getElementById('temp_password');
        const icon = this.querySelector('i');
        
        if (passwordInput.type === 'password') {
            passwordInput.type = 'text';
            icon.classList.remove('fa-eye');
            icon.classList.add('fa-eye-slash');
        } else {
            passwordInput.type = 'password';
            icon.classList.remove('fa-eye-slash');
            icon.classList.add('fa-eye');
        }
    });
    
    // Auto-dismiss alerts
    setTimeout(function() {
        const alerts = document.querySelectorAll('.alert:not(.alert-info)');
        alerts.forEach(alert => {
            const bsAlert = new bootstrap.Alert(alert);
            bsAlert.close();
        });
    }, 5000);
</script>
{% endblock %}
